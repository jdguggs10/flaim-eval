# flaim-eval

MCP eval harness and skill-development workspace for [Flaim](https://github.com/jdguggs10/flaim).

## What it does
1. Debugs model + MCP behavior by capturing full tool-call traces.
2. Validates server-side observability for each eval question using per-trace log enrichment.
3. Supports prompt/instruction iteration through repeatable scenario runs.

## Quick start

```bash
npm install
cp .env.example .env
# add OPENAI_API_KEY

# Option A: API key (recommended â€” no browser needed)
# Set FLAIM_EVAL_API_KEY in .env (get from project maintainer)

# Option B: OAuth (requires browser for initial bootstrap)
# npm run bootstrap

npm run eval
npm run eval who_is_on_my_roster
npm run enrich -- <run_id> [trace_id]
npm run accept -- <run_id>
npm run report -- <run_id>
```

## Docs

- `docs/INDEX.md`: entry point and doc map.
- `docs/OPERATIONS.md`: daily usage and command flows.
- `docs/OBSERVABILITY.md`: trace/log contract and filtering model.
- `docs/TROUBLESHOOTING.md`: failure modes and recovery.
- `docs/ACCEPTANCE.md`: formal E2E validation checklist.

## Artifact layout

```text
runs/<run_id>/
  manifest.json
  summary.json
  acceptance-summary.json            # generated by `npm run accept -- <run_id>`
  report.md                          # generated by `npm run report -- <run_id>`
  <trace_id>/                           # e.g. trace_who_is_on_my_roster_000
    trace.json
    logs/
      fantasy-mcp.json
      espn-client.json
      yahoo-client.json
      auth-worker.json
```

## Observability defaults

- Trace isolation is strict by default (`FLAIM_EVAL_ALLOW_RUN_FALLBACK=0`).
- Re-enrichment retries are configurable:
  - `FLAIM_EVAL_REENRICH_ATTEMPTS` (default: `6`)
  - `FLAIM_EVAL_REENRICH_DELAY_MS` (default: `15000`)
  - `FLAIM_EVAL_REENRICH_WINDOW_EXPAND_MS` (default: `30000`)

## Related design docs

- Current cross-repo execution status:
  - `../flaim/docs/dev/CURRENT-EXECUTION-STATE.md`
- Historical scope/design reference:
  - `../flaim/docs/archive/README.md`
